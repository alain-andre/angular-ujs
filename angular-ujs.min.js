/*! angular-ujs - v0.3.4 - 2013-12-30
 * https://github.com/tomchentw/angular-ujs
 * Copyright (c) 2013 [tomchentw](https://github.com/tomchentw/);
 * Licensed [MIT](http://tomchentw.mit-license.org/)
 */
(function(){angular.module("angular.ujs",[]).factory("rails",["$window","$document","$compile"].concat(function(a,b,c){var d;return d=function(){var a,c,d,e,f,g;for(a={},c=b.find("meta"),d=0,e=c.length;e>d;++d)f=d,g=c.eq(f),a[g.attr("name")]=g.attr("content");return a},{getMetaTags:d,createMethodFormElement:function(a,e){var f,g,h;return f=d(),g=e.$new(),g._method=a.method,h=c('<form class="ng-hide" method="POST" action="'+a.href+'">\n  <input type="text" name="_method" ng-model="_method">\n  <input type="text" name="'+f["csrf-param"]+'" value="'+f["csrf-token"]+'">\n</form>')(g),b.find("body").append(h),h},noopConfirmCtrl:function(){this.allowAction=function(){return!0},this.denyDefaultAction=function(a){a.preventDefault(),a.stopPropagation()}},noopRemoteFormCtrl:function(){this.submit=function(a){return a[0].submit(),{then:angular.noop}}}}})).controller("RailsConfirmCtrl",["$window","rails"].concat(function(a,b){b.noopConfirmCtrl.apply(this,arguments),this.allowAction=function(b){var c;return c=b.confirm,angular.isDefined(c)&&a.confirm(c)}})).directive("confirm",[].concat(function(){var a;return a=function(a,b,c,d){var e,f;e=d[0],f=function(a){e.allowAction(c)||e.denyDefaultAction(a)},b.on("click",f),a.$on("$destroy",function(){b.off("click",f)})},{restrict:"A",require:["confirm"],compile:function(b,c){var d;return d=c.$attr,"data-confirm"===d.confirm&&"data-remote"!==d.remote&&"data-method"!==d.method?a:void 0}}})).controller("RailsRemoteFormCtrl",["$scope","$parse","$http"].concat(function(a,b,c){var d,e;d=function(b){a.$emit("rails:remote:success",b)},e=function(b){a.$emit("rails:remote:error",b)},this.submit=function(a,f){var g,h,i,j,k={}.hasOwnProperty;if(g=a.scope(),h={},f+""!="true")console.log("parsing modelName",f),b(f).assign(h,g.$eval(f));else for(i in g)if(k.call(g,i)){if(j=g[i],"this"===i||"$"===i[0])continue;h[i]=j}return console.log(h,f,f===!0),c({method:a.attr("method"),url:a.attr("action"),data:h}).then(d,e)}})).directive("remote",["rails"].concat(function(a){var b;return b=function(b,c,d,e){var f,g,h;f=e[0],g=e[1]||new a.noopConfirmCtrl,h=function(a){g.allowAction(d)&&g.denyDefaultAction(a),f.submit(c,d.remote)},c.on("submit",h),b.$on("$destroy",function(){c.off("submit",h)})},{require:["remote","?confirm"],restrict:"A",controller:"RailsRemoteFormCtrl",compile:function(a,c){return"data-remote"===c.$attr.remote?b:void 0}}})).directive("method",["rails"].concat(function(a){var b;return b=function(b,c,d,e){var f,g,h;f=e[0]||new a.noopRemoteFormCtrl,g=e[1]||new a.noopConfirmCtrl,console.log(f),h=function(c){var e;console.log("onClickHandler"),g.allowAction(d)&&g.denyDefaultAction(c),e=a.createMethodFormElement(d,b),console.log("before remoteCtrl.submit"),f.submit(e,!0).then(function(){e.scope().$destroy(),e.remove()})},console.log("setup onClickHandler"),c.on("click",h),b.$on("$destroy",function(){c.off("click",h)})},{require:["?remote","?confirm"],restrict:"A",compile:function(a,c){return"data-method"===c.$attr.method?b:void 0}}}))}).call(this);